import { collectPackages } from "@alexaegis/standard-version";
const getPackageJsonNameWithoutOrg = (packageName = "") => {
  let packageNameWithoutOrg = packageName;
  if (packageName.includes("/")) {
    const [, ...splitPackageName] = packageName.split("/");
    packageNameWithoutOrg = splitPackageName.join("/");
  }
  return packageNameWithoutOrg;
};
const getLocalPackageNames = () => {
  return collectPackages().subPackages.map(
    (p) => getPackageJsonNameWithoutOrg(p.packageJson.name)
  );
};
const createCommitlintConfig = () => {
  const genericScopes = ["docs", "lint", "changelog", "release"];
  const localPackageNames = getLocalPackageNames();
  return {
    extends: ["@commitlint/config-conventional"],
    type: ["feat", "fix", "test", "docs", "refactor", "build", "ci", "perf", "revert", "style"],
    rules: {
      "scope-enum": [2, "always", [...genericScopes, ...localPackageNames]]
    }
  };
};
export {
  createCommitlintConfig,
  getLocalPackageNames
};
